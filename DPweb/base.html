<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>HeyShop</title>
    <link rel="stylesheet" href="base.css">
    <link rel="icon" href="https://gitee.com/dplcz/image_html/raw/master/JD_FASTAPI/analysis.png" sizes="32x32">

</head>
<body>
<div class="main">
    <div class="slotholder"
         style="position: absolute; top: 0px; left: 0px; z-index: 0; width: 100%; height: 100%; visibility: inherit; opacity: 1; transform: matrix(1, 0, 0, 1, 0, 0);">
        <div class="tp-bgimg defaultimg "
             style="background-color: rgba(0, 0, 0, 0); background-repeat: no-repeat; background-image: url(/img/base.png); background-size: cover; background-position: center center; width: 100%; height: 100%; opacity: 1; visibility: inherit; z-index: 20;"
             src="/img/base.png">
        </div>
        <div class="text-box">
            <!--            <div class="text-title"></div>-->
            <div class="tp-parallax-wrap"
                 style="position: absolute; display: block; visibility: visible; left: 0px; top: 390px; z-index: 8; min-width: 100%;">
                <div class="tp-loop-wrap" style="position: absolute; display: block; min-width: 100%;">
                    <div class="tp-mask-wrap"
                         style="position: absolute; display: block; min-width: 100%; overflow: hidden; transform: matrix(1, 0, 0, 1, 0, 0);">
                        <div class="tp-caption tp-resizeme secand_text"
                             data-x="['center','center','center','center','center','center']"
                             data-hoffset="['0','80','80','0']" data-y="['middle','middle','middle','middle']"
                             data-voffset="['0','0','0','0','0']" data-fontsize="['48','48','48','28','28','22']"
                             data-lineheight="['60','60','60','36','36','30']" data-width="100%" data-height="none"
                             data-whitespace="normal" data-type="text" data-responsive_offset="on"
                             data-transform_idle="o:1;"
                             data-frames="[{&quot;delay&quot;:10,&quot;speed&quot;:1500,&quot;frame&quot;:&quot;0&quot;,&quot;from&quot;:&quot;y:[100%];z:0;rX:0deg;rY:0;rZ:0;sX:1;sY:1;skX:0;skY:0;opacity:0;&quot;,&quot;mask&quot;:&quot;x:0px;y:[100%];s:inherit;e:inherit;&quot;,&quot;to&quot;:&quot;o:1;&quot;,&quot;ease&quot;:&quot;Power2.easeInOut&quot;},{&quot;delay&quot;:&quot;wait&quot;,&quot;speed&quot;:1500,&quot;frame&quot;:&quot;999&quot;,&quot;to&quot;:&quot;y:[175%];&quot;,&quot;mask&quot;:&quot;x:inherit;y:inherit;s:inherit;e:inherit;&quot;,&quot;ease&quot;:&quot;Power2.easeInOut&quot;}]"
                             data-textalign="['center','center','center','center','center','center']"
                             style="z-index: 8; font-family: Poppins, sans-serif; font-weight: 700; color: rgb(255, 255, 255); visibility: inherit; transition: none 0s ease 0s; text-align: center; line-height: 60px; border-width: 0px; margin: 0px; padding: 0px; letter-spacing: 0px; font-size: 48px; white-space: normal; min-height: 0px; min-width: 100%; max-height: none; max-width: 100%; opacity: 1; transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); transform-origin: 50% 50% 0px;"
                             id="layer-768752942">电商爬虫及可视化分析 <br>基于Scrapy框架与FastAPI框架
                        </div>
                    </div>
                </div>
            </div>

            <div class="tp-parallax-wrap"
                 style="position: absolute;display: block;visibility: visible;/* left: 850px; */top: 550px;z-index: 2;min-width: 100%;">
                <div class="tp-loop-wrap" style="position:absolute;display:block;min-width: 100%;">
                    <div class="tp-mask-wrap"
                         style="position: absolute;display: block;overflow: hidden;transform: matrix(1, 0, 0, 1, 0, 0);min-width: 100%;">
                        <div class="tp-caption tp-resizeme slider_button"
                             data-x="['center','center','center','center','center','center']"
                             data-hoffset="['0','0','0','0']" data-y="['middle','middle','middle','middle']"
                             data-voffset="['130','130','130','100','100','100']" data-width="none" data-height="none"
                             data-whitespace="nowrap" data-type="text" data-responsive_offset="on"
                             data-frames="[{&quot;delay&quot;:10,&quot;speed&quot;:1500,&quot;frame&quot;:&quot;0&quot;,&quot;from&quot;:&quot;y:[100%];z:0;rX:0deg;rY:0;rZ:0;sX:1;sY:1;skX:0;skY:0;opacity:0;&quot;,&quot;mask&quot;:&quot;x:0px;y:[100%];s:inherit;e:inherit;&quot;,&quot;to&quot;:&quot;o:1;&quot;,&quot;ease&quot;:&quot;Power2.easeInOut&quot;},{&quot;delay&quot;:&quot;wait&quot;,&quot;speed&quot;:1500,&quot;frame&quot;:&quot;999&quot;,&quot;to&quot;:&quot;y:[175%];&quot;,&quot;mask&quot;:&quot;x:inherit;y:inherit;s:inherit;e:inherit;&quot;,&quot;ease&quot;:&quot;Power2.easeInOut&quot;}]"
                             data-textalign="['center','center','center','center','center','center']"
                             id="layer-436975764"
                             style="visibility: inherit; transition: none 0s ease 0s; text-align: center; line-height: 26px; border-width: 0px; margin: 0px; padding: 0px; letter-spacing: 0px; font-weight: 400; font-size: 14px; white-space: nowrap; min-height: 0px; min-width: 0px; max-height: none; max-width: none; opacity: 1; transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); transform-origin: 50% 50% 0px;">
                            <form name="f" id="form" class="fm" style="height: 110px;" method="get" action="/search/">
                                <input type="text" class="s_ipt" name="kw" id="kw" maxlength="100" autocomplete="off"
                                       placeholder="输入要搜索的商品">
                                <input class="bg_btn" type="button" value="搜索商品"
                                       style="transition: none 0s ease 0s;text-align: inherit;line-height: 46px;border-width: 0px;margin: 35px 0px 0px 0px;padding: 0px;letter-spacing: 0px;font-weight: 600;font-size: 25px;color: white;border-radius: 10px 10px 10px 10px;/* float: right; */"
                                       onclick="chech()">
                            </form>
                            <form name="f" id="form_up" class="fm" style="height: 110px;" method="post"
                                  action="/search/" enctype="multipart/form-data">

                                <input class="bg_btn" type="button" value="上传文件" id="btn_up"
                                       style="transition: none 0s ease 0s;text-align: inherit;line-height: 46px;border-width: 0px;margin: 35px 0px 0px 0px;padding: 0px;letter-spacing: 0px;font-weight: 600;font-size: 25px;color: white;border-radius: 10px 10px 10px 10px;background-image: linear-gradient(to right,#b2b6ca 0%,#3aeeeb 51%,#07a2a2 100%)/* float: right; */"
                                       onclick="choose()">
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <button style="position:absolute; top:5%;left:90%;width:90px;height:50px;font-size:0.8vw;font-weight:bold;color:#f4bf3b;background-image: linear-gradient(to right, rgba(79,100,200,0.8) 0%, rgba(79,229,200,0.7) 51%, rgba(79,229,200,0.8) 100%);border-radius:5px 5px 5px 5px;border:0;font-family: poppins, sans-serif;background-size: 200% auto;"
                onclick="showTips()">
            查看说明
        </button>
        <div id='tips'
             style="position: absolute;top: 10%;left: 20%;width: 60%;height: 80%;z-index: 1000;display: none;">
            <img id='close' src="/img/x.png" style="position:absolute;left: 95%;width: 5%;height:5%"
                 onclick="closeTips()">
            <img
                    src="/img/base_tip.png"
                    style="width: 100%;height: 100%;max-height: 650px;">
        </div>
    </div>
    <!--    <button><a href="http://127.0.0.1:8000/base/">base</a></button>-->

</div>
<script src="ball/js/jquery.js"></script>
<script type="text/javascript">
    var keyword = document.getElementById('kw')
    var form = document.getElementById('form')
    var up = document.getElementById('upload')
    var date = new Date().getTime().toString();
    var time = date.substring(date.length - 6)

    function chech() {
        if (keyword.value == '') {
            alert('请输入要搜索的商品名称');
        } else {
            form.submit()
        }
    }

    function choose() {
        alert('请选择由本系统生成的.xlsx后缀文件')
        document.getElementById('load_xls').click()
    }

    $('#btn_up').after('<input type="file" id="load_xls" name="file" style="display:none" onchange ="uploadFile()" accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet">');


    function uploadFile() {
        var myform = new FormData();
        const file = $('#load_xls')[0].files[0]
        const type = file.name.split('.')[1]
        const renameFile = new File([file], time + '.' + type, {type: file.type})
        myform.append('file', renameFile);
        $.ajax({
            url: "/base/upload",
            type: "POST",
            data: myform,
            contentType: false,
            processData: false,
            success: function (data) {
                console.log(data);
                window.location.href = "/view/" + time;
            },
            error: function (data) {
                console.log(data);
                alert('上传失败');
            }
        })
    }

    function showTips() {
        document.getElementById('tips').style.display = 'inline'
    }

    function closeTips() {
        document.getElementById('tips').style.display = 'none'
    }
</script>
<script>
    (function (doc, win) {
        var docEl = doc.documentElement,
            resizeEvt = 'orientationchange' in window ? 'orientationchange' : 'resize',
            recalc = function () {
                var clientWidth = docEl.clientWidth;
                if (!clientWidth) return;
                if (clientWidth >= 640) {
                    docEl.style.fontSize = '100px';
                } else {
                    docEl.style.fontSize = 100 * (clientWidth / 640) + 'px';
                }
            };

        if (!doc.addEventListener) return;
        win.addEventListener(resizeEvt, recalc, false);
        doc.addEventListener('DOMContentLoaded', recalc, false);
    })(document, window);
</script>
</body>
</html>

